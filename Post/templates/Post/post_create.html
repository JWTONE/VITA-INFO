{% extends "base.html" %}
{% load crispy_forms_tags %}

{% block content %}
<h1>글 쓰기</h1>

<form id="postForm" enctype="multipart/form-data">
    {% csrf_token %}
    {{ form | crispy }}
    <button type="button" onclick="submitForm()">저장</button>
</form>
<a href="javascript:void(0);" onclick="history.back();">목록으로</a>

<script>
    function submitForm() {
        const form = document.getElementById('postForm');
        const formData = new FormData(form);

        axios.post("/api/post/", formData, {
            headers: {
                'Content-Type': 'multipart/form-data'
            }
        })
        .then(response => {
            // 성공 시 목록 페이지로 리디렉션
            history.back();
        })
        .catch(error => {
            console.error('폼 제출 중 오류가 발생했습니다:', error);
            alert('폼 제출 중 오류가 발생했습니다. 다시 시도해 주세요.');
        });
    }
</script>
{% endblock content %}